Du bist ein erfahrener Python-Entwickler mit 20 Jahren Berufserfahrung, 
spezialisiert auf API-Integration, Bildverarbeitung und Dokumenten-Automatisierung.

Erstelle ein vollstÃ¤ndiges, produktionsreifes Python-Skript zur automatischen 
Digitalisierung von Metaplan- und Workshop-Board-Fotos Ã¼ber die OpenRouter API.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
TECHNISCHE RAHMENBEDINGUNGEN
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

API:        OpenRouter (https://openrouter.ai/api/v1/chat/completions)
Auth:       Bearer Token (OPENROUTER_API_KEY als Umgebungsvariable)
Modell:     Standard: google/gemini-2.0-flash (konfigurierbar)
            Fallback:  anthropic/claude-sonnet-4-5 (bessere Handschriften)
Bildformate: JPG, PNG, WEBP (Base64-Encoding)
Output:     Zwei Markdown-Dateien pro Board:
            - {boardname}_Raw.md      (Rohdaten-Transkription)
            - {boardname}_Summary.md  (Executive Summary + FlieÃŸtext)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
PFLICHT-FEATURES DES SKRIPTS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. STRUKTURANALYSE (Schritt 1 des Prozessleitfadens)
   Der API-Prompt muss das Modell anweisen, VOR der Transkription folgendes 
   zu analysieren und im Output zu dokumentieren:
   - Layout-Typ erkennen: Spalten / Cluster / Matrix / Freiform / Mindmap
   - Farb-Semantik auswerten: Haben Zettelfarben inhaltliche Bedeutung?
     (Gelb=Fakten, GrÃ¼n=Ideen, Rot=Kritik o.Ã¤.) â†’ wenn unklar: "generisch"
   - Priorisierungs-Indikatoren zÃ¤hlen:
     * Klebepunkte/Votes (nach Farbe differenziert, exakt zÃ¤hlen)
     * Strichlisten, Ausrufezeichen, Unterstreichungen
   - Verbindungen dokumentieren: Pfeile/Linien zwischen Zetteln erfassen

2. ROHDATEN-ERFASSUNG (Schritt 2)
   Generierung der *_Raw.md mit folgenden Regeln:
   - Spalten  â†’ ## Ãœberschriften
   - Cluster  â†’ ## Cluster-Titel + verschachtelte Listen
   - Zettel   â†’ * Listenpunkte (Text 1:1, inkl. AbkÃ¼rzungen & Tippfehler)
   - Unleserliches â†’ [unleserlich] oder [?]
   - Votes/Punkte â†’ in Klammern: (3 rote Punkte, 1 grÃ¼ner Punkt)
   - Farben relevant â†’ (Farbe: Rot) als Annotation

3. BEREINIGUNG & ANREICHERUNG (Schritt 3)
   Zweiter API-Call der die Raw.md als Input nimmt und bereinigt:
   - AbkÃ¼rzungen auflÃ¶sen (nur wenn Kontext eindeutig)
   - Absteigende Sortierung nach Votes (falls vorhanden)
   - Farb-Annotations entfernen wenn inhaltlich irrelevant (Noise Reduction)
   - Klebepunkte auf Zahlenwerte reduzieren: "5 Stimmen"

4. SYNTHESE (Schritt 4)
   Generierung der *_Summary.md:
   - Executive Summary (max. 10 Zeilen):
     * Kernaussage "in a nutshell"
     * Top 1-2 Themen/BeschlÃ¼sse
     * GrÃ¶ÃŸte HÃ¼rde oder Kontroverse
   - Detaillierter Bericht:
     * Stichpunkte â†’ ausformulierte SÃ¤tze
     * Strukturiert nach Themenbereichen aus Schritt 1
     * Pfeile/Verbindungen verbalisieren: "Thema A fÃ¼hrt zu Thema B"

5. BOARD-KONTEXT-TEMPLATES (vorkonfiguriert, wÃ¤hlbar per Argument)
   - retrospektive  â†’ "Was lief gut / schlecht / MaÃŸnahmen"
   - ideensammlung  â†’ "Cluster nach Themen, Punkte = Priorisierung"
   - metaplan       â†’ "Fragen oben, Antworten als Karten darunter"
   - 5s_audit       â†’ "Sortieren / Setzen / SÃ¤ubern / Standardisieren / Selbstdisziplin"
   - custom         â†’ Freie Kontexteingabe per --context "..."

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
CLI-INTERFACE (argparse)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

python digitize_board.py --image board.jpg
                         --template retrospektive
                         --context "Lager-Team, rote Punkte = Votes"
                         --model google/gemini-2.0-flash
                         --output ./output/
                         --confidence  (ergÃ¤nzt unsichere Stellen mit Konfidenz-Score)
                         --batch ./ordner_mit_fotos/  (alle Bilder im Ordner verarbeiten)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
CODE-QUALITÃ„TS-ANFORDERUNGEN
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

- Klassen-basiert: BoardDigitizer-Klasse mit klarer Methoden-Trennung
  * analyze_structure()
  * transcribe_raw()
  * clean_and_enrich()
  * synthesize_summary()
  * process_board()  (orchestriert alle Schritte)

- Fehlerbehandlung:
  * API-Timeout mit Retry-Logik (max. 3 Versuche, exponential backoff)
  * HTTPError mit sprechenden Fehlermeldungen
  * Fallback auf alternatives Modell bei Fehler
  * Logging in digitize_board.log

- Config via .env-Datei (python-dotenv):
  OPENROUTER_API_KEY=sk-or-...
  DEFAULT_MODEL=google/gemini-2.0-flash
  FALLBACK_MODEL=anthropic/claude-sonnet-4-5
  OUTPUT_DIR=./output
  MAX_TOKENS=4000

- Type Hints durchgehend (Python 3.10+)
- Docstrings fÃ¼r alle Ã¶ffentlichen Methoden
- requirements.txt mitliefern:
  requests, python-dotenv, pathlib, argparse

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
SYSTEM-PROMPT FÃœR DIE API-CALLS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Der System-Prompt soll folgenden Analyse-Ablauf erzwingen 
(exakte Reihenfolge, im Output als Sektionen sichtbar):

"Analysiere dieses Bild.
1. Beschreibe zuerst die Struktur: Spalten, Cluster oder Matrix?
2. Haben die Farben der Zettel eine erkennbare Bedeutung?
3. Gibt es Voting-Punkte? Wenn ja, zÃ¤hle sie exakt nach Farbe.
4. Erstelle dann ein Markdown das diese Struktur abbildet.
   LÃ¶se AbkÃ¼rzungen auf und sortiere nach Relevanz (falls Punkte vorhanden).
5. Markiere alle unsicheren Erkennungen mit [?] und gib am Ende 
   eine GesamteinschÃ¤tzung deiner ErkennungsqualitÃ¤t ab (0-100%)."

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
AUSGABE-FORMAT
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Liefere:
1. Das vollstÃ¤ndige, lauffÃ¤hige Python-Skript (digitize_board.py)
2. Eine .env.example Datei
3. Eine requirements.txt
4. Einen kurzen Kommentar-Block am Anfang des Skripts mit:
   - Kurzbeschreibung
   - Autor-Platzhalter
   - Version 1.0.0
   - Datum (heute)

Das Skript soll direkt ausfÃ¼hrbar sein ohne weitere Anpassungen auÃŸer 
dem Setzen des API-Keys in der .env Datei.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
BENUTZERANLEITUNG (PFLICHT-BESTANDTEIL)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Erstelle im Anschluss an das Skript eine vollstÃ¤ndige Benutzeranleitung 
als eigene Markdown-Datei: README.md

Die Anleitung muss folgende Abschnitte enthalten:

## 1. Voraussetzungen
   - Python-Version (3.10+)
   - BenÃ¶tigte Pakete (mit Installationsbefehl: pip install -r requirements.txt)
   - OpenRouter-Account und wo der API-Key zu finden ist
     (https://openrouter.ai/keys)
   - Welche Modelle Vision-fÃ¤hig sind und wie man das auf OpenRouter prÃ¼ft

## 2. Einrichtung (Schritt-fÃ¼r-Schritt)
   - .env.example zu .env kopieren und befÃ¼llen
   - Welche Felder in der .env ZWINGEND gesetzt werden mÃ¼ssen 
     (mit Beispielwerten)
   - Welche Felder optional sind und was ihre Standardwerte sind
   - Kurztest ob die Einrichtung funktioniert hat:
     python digitize_board.py --test

## 3. Grundlegende Nutzung
   - Einfachstes Beispiel (ein Bild, keine Optionen)
   - Beispiel mit Template-Auswahl
   - Beispiel mit eigenem Kontext (--context)
   - Batch-Verarbeitung eines ganzen Ordners
   - Tabellarische Ãœbersicht ALLER CLI-Parameter mit:
     * Parameter-Name
     * Pflicht/Optional
     * Standardwert
     * Kurzbeschreibung

## 4. Ausgabe-Dateien verstehen
   - Was steht in der _Raw.md und wofÃ¼r ist sie gedacht?
   - Was steht in der _Summary.md und wie ist sie aufgebaut?
   - Wo werden die Dateien gespeichert (OUTPUT_DIR)?
   - Was bedeuten die Annotationen [unleserlich], [?] und (Konfidenz: XX%)?

## 5. Anpassungen & Konfiguration
   Dieser Abschnitt ist besonders wichtig. Liste ALLE Stellen im Skript,
   die der Nutzer anpassen kann oder muss, mit:
   - Zeilennummer im Skript
   - Was genau angepasst werden kann
   - Warum man es anpassen wÃ¼rde
   - Beispiel fÃ¼r die Anpassung
   
   Mindestens folgende Punkte abdecken:
   a) Modell wechseln (wann Gemini, wann Claude, wann GPT-4o?)
   b) Eigene Board-Templates hinzufÃ¼gen (BOARD_TEMPLATES-Dictionary)
   c) System-Prompt erweitern (z.B. fÃ¼r spezifische AbkÃ¼rzungs-Listen
      wie interne REWE-Fachbegriffe oder AbteilungskÃ¼rzel)
   d) max_tokens erhÃ¶hen bei sehr groÃŸen/vollen Boards
   e) Retry-Verhalten anpassen (Anzahl Versuche, Wartezeit)
   f) Output-Format Ã¤ndern (z.B. nur Raw, nur Summary, oder beides)
   g) Sprache des Outputs (Deutsch/Englisch) konfigurieren

## 6. Fehlerbehebung (Troubleshooting)
   Tabellarische Auflistung hÃ¤ufiger Fehler:
   | Fehlermeldung / Symptom | Ursache | LÃ¶sung |
   Mindestens abdecken:
   - API-Key ungÃ¼ltig oder nicht gesetzt
   - Modell unterstÃ¼tzt kein Vision (kein Bild-Input)
   - Bild zu groÃŸ (Base64-Limit)
   - Timeout bei groÃŸen Boards
   - Output ist leer oder unvollstÃ¤ndig
   - Unleserliche Handschrift â†’ Tipps fÃ¼r bessere FotoqualitÃ¤t

## 7. Tipps fÃ¼r beste Ergebnisse
   - Optimale Foto-Bedingungen (Licht, Winkel, AuflÃ¶sung)
   - Wann welches Modell wÃ¤hlen
   - Wie man den --context Parameter effektiv nutzt um 
     domÃ¤nenspezifisches Wissen einzubringen
     (Beispiel: "Lager-Team Zentrallager, rote Punkte = PrioritÃ¤t,
      AbkÃ¼rzungen: ZL=Zentrallager, FS=FrÃ¼hschicht, SS=SpÃ¤tschicht")
   - Umgang mit mehrteiligen Boards (mehrere Fotos eines Boards)

## 8. Beispiel-Workflow (End-to-End)
   Ein vollstÃ¤ndiges, kommentiertes Beispiel von Foto bis fertiger Summary:
   - Fiktives Board-Foto: "Retro Lager-Team KW12"
   - Kompletter CLI-Befehl mit allen sinnvollen Optionen
   - Wie der erwartete Output (_Raw.md und _Summary.md) aussehen wÃ¼rde
     (als ausformulierte Beispiel-Ausgabe im Markdown-Codeblock)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
GESAMTE LIEFERLISTE (ZUSAMMENFASSUNG)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Liefere am Ende exakt diese 4 Dateien, jeweils klar getrennt und 
mit Dateinamen als Ãœberschrift:

  ğŸ“„ digitize_board.py   â†’ Das vollstÃ¤ndige Python-Skript
  ğŸ“„ .env.example        â†’ Konfigurationsvorlage
  ğŸ“„ requirements.txt    â†’ AbhÃ¤ngigkeiten
  ğŸ“„ README.md           â†’ VollstÃ¤ndige Benutzeranleitung (wie oben beschrieben)

Trenne die Dateien im Output mit:
--- DATEI: dateiname.py ---
[Inhalt]
--- ENDE: dateiname.py ---